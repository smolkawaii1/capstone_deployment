var ut=Object.create;var L=Object.defineProperty;var ht=Object.getOwnPropertyDescriptor;var Rt=Object.getOwnPropertyNames;var At=Object.getPrototypeOf,Ct=Object.prototype.hasOwnProperty;var Kt=(e,t)=>{for(var o in t)L(e,o,{get:t[o],enumerable:!0})},E=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of Rt(t))!Ct.call(e,l)&&l!==o&&L(e,l,{get:()=>t[l],enumerable:!(r=ht(t,l))||r.enumerable});return e},g=(e,t,o)=>(E(e,t,"default"),o&&E(o,t,"default")),B=(e,t,o)=>(o=e!=null?ut(At(e)):{},E(t||!e||!e.__esModule?L(o,"default",{value:e,enumerable:!0}):o,e)),wt=e=>E(L({},"__esModule",{value:!0}),e);var y={};Kt(y,{RefineKbar:()=>j,RefineKbarPropsContext:()=>q,RefineKbarProvider:()=>It,useRefineKbar:()=>P});module.exports=wt(y);var k=B(require("react")),rt=require("kbar");g(y,require("kbar"),module.exports);var C=require("react"),s=require("@refinedev/core"),f=require("kbar");var A=e=>e.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase());var at=require("@refinedev/core");var P=()=>{let e=(0,s.useTranslate)(),{resource:t,resources:o,id:r,action:l}=(0,s.useResource)(),d=(0,s.useRouterType)(),m=(0,at.useGetToPath)(),R=(0,s.useGo)(),{mutate:st}=(0,s.useDelete)(),{push:S,list:vt,create:Tt,show:Bt,edit:Pt}=(0,s.useNavigation)(),pt=(0,C.useContext)(f.KBarContext),{can:p}=(0,s.useCanWithoutCache)(),[D,ct]=(0,C.useState)([]);(0,C.useEffect)(()=>{(async()=>await Promise.all(lt().flatMap(a=>dt(a))))().then(a=>ct(a.flatMap(b=>b)))},[o,r,t,l]),(0,C.useEffect)(()=>{D.length===0&&pt.query.setVisualState(f.VisualState.hidden)},[D]);let lt=()=>{let n=[...o],a=n==null?void 0:n.findIndex(b=>{var z,I;return((z=b.identifier)!=null?z:b==null?void 0:b.name)===((I=t==null?void 0:t.identifier)!=null?I:t==null?void 0:t.name)});if(a>0){let b=n[a];n.splice(a,1),n.splice(0,0,b)}return n},dt=async n=>{var J,O,Q,X,Y,Z,_,tt,et,nt,ot,it;let{name:a,label:b,list:z,create:I,canCreate:mt,canEdit:ft,canShow:yt,icon:bt,show:F,canDelete:gt,edit:H,route:kt}=n,G=(X=(Q=(J=n==null?void 0:n.meta)==null?void 0:J.label)!=null?Q:(O=n==null?void 0:n.options)==null?void 0:O.label)!=null?X:b,v=(tt=(_=(Y=n==null?void 0:n.meta)==null?void 0:Y.icon)!=null?_:(Z=n==null?void 0:n.options)==null?void 0:Z.icon)!=null?tt:bt,xt=(it=(ot=(et=n==null?void 0:n.meta)==null?void 0:et.canDelete)!=null?ot:(nt=n==null?void 0:n.options)==null?void 0:nt.canDelete)!=null?it:gt,T=G!=null?G:e(`${n.name}.${n.name}`,(0,s.userFriendlyResourceName)(n.name,"plural")),K=[];if(z&&(t!==void 0&&(t==null?void 0:t.name)!==a||l!==void 0&&(t==null?void 0:t.name)===a)){let{can:x}=await(p==null?void 0:p({resource:a,action:"show",params:{id:r,resource:n}}))||{can:!0};x&&K.push((0,f.createAction)({name:e("actions.list",A("list")),section:T,icon:v,perform:()=>{let i=m({resource:n,action:"list",legacy:d==="legacy"});i&&(d==="legacy"?S(i):R({to:i}))}}))}if((mt||!!I)&&I&&(l!=="create"||(t==null?void 0:t.name)!==a)){let{can:x}=await(p==null?void 0:p({resource:a,action:"create",params:{resource:n}}))||{can:!0};x&&K.push((0,f.createAction)({name:e("actions.create",A("create")),section:T,icon:v,keywords:"new",perform:()=>{let i=m({resource:n,action:"create",legacy:d==="legacy"});i&&(d==="legacy"?S(i):R({to:i}))}}))}if((t==null?void 0:t.name)===a&&r){if((yt||!!F)&&F&&l!=="show"){let{can:x}=await(p==null?void 0:p({resource:a,action:"show",params:{id:r,resource:n}}))||{can:!0};x&&K.push((0,f.createAction)({name:e("actions.show",A("show")),section:T,icon:v,perform:()=>{let i=m({resource:n,action:"show",legacy:d==="legacy",meta:{id:r}});i&&(d==="legacy"?S(i):R({to:i}))}}))}if((ft||!!H)&&H&&l!=="edit"){let{can:x}=await(p==null?void 0:p({resource:a,action:"show",params:{id:r,resource:n}}))||{can:!0};x&&K.push((0,f.createAction)({name:e("actions.edit",A("edit")),section:T,icon:v,perform:()=>{let i=m({resource:n,action:"edit",legacy:d==="legacy",meta:{id:r}});i&&(d==="legacy"?S(i):R({to:i}))}}))}if(xt){let{can:x}=await(p==null?void 0:p({resource:a,action:"show",params:{id:r,resource:n}}))||{can:!0};x&&K.push({id:"delete",name:e("actions.delete",A("delete")),section:T,icon:v},(0,f.createAction)({name:e("buttons.delete",A("delete")),section:e("buttons.confirm","Are you sure?"),parent:"delete",perform:()=>{st({resource:n.name,id:r},{onSuccess:()=>{let i=m({resource:n,action:"list",legacy:d==="legacy"});i&&(d==="legacy"?S(i):R({to:i}))}})}}),(0,f.createAction)({name:e("buttons.cancel","Cancel"),parent:"delete",perform:()=>null}))}}return K};(0,f.useRegisterActions)(D,[D])};var w=B(require("react")),h=require("kbar");var U=()=>w.default.createElement(h.KBarPortal,null,w.default.createElement(h.KBarPositioner,{style:{opacity:1,transition:"background 0.35s cubic-bezier(0.4, 0, 0.2, 1) 0s",backdropFilter:"saturate(180%) blur(1px)",background:"rgba(0, 0, 0, 0.1)",zIndex:"9999"}},w.default.createElement(h.KBarAnimator,{style:{maxWidth:"600px",width:"100%",background:"white",color:"black",borderRadius:"8px",overflow:"hidden",boxShadow:"0px 4px 4px rgba(0, 0, 0, 0.25)"}},w.default.createElement(h.KBarSearch,{style:{padding:"12px 16px",fontSize:"16px",width:"100%",boxSizing:"border-box",outline:"none",border:"none",background:"rgb(252 252 252)",color:"black"}}),w.default.createElement(V,null))));var M=B(require("react")),N=require("kbar");var St={padding:"8px 16px",fontSize:"14px",textTransform:"uppercase",fontWeight:"bold",opacity:.5},V=()=>{let{results:e,rootActionId:t}=(0,N.useMatches)();return M.default.createElement(N.KBarResults,{items:e,onRender:({item:o,active:r})=>typeof o=="string"?M.default.createElement("div",{style:St},o):M.default.createElement(W,{action:o,active:r,currentRootActionId:t})})};var c=B(require("react")),W=c.default.forwardRef(({action:e,active:t,currentRootActionId:o},r)=>{var d;let l=c.default.useMemo(()=>{if(!o)return e.ancestors;let m=e.ancestors.findIndex(R=>R.id===o);return e.ancestors.slice(m+1)},[e.ancestors,o]);return c.default.createElement("div",{ref:r,style:{padding:"12px 16px",background:t?"rgba(0 0 0 / 0.05)":"transparent",borderLeft:`2px solid ${t?"rgb(28 28 29)":"transparent"}`,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"}},c.default.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center",fontSize:14}},e.icon&&e.icon,c.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},c.default.createElement("div",null,l.length>0&&l.map(m=>c.default.createElement(c.default.Fragment,{key:m.id},c.default.createElement("span",{style:{opacity:.5,marginRight:8}},m.name),c.default.createElement("span",{style:{marginRight:8}},"\u203A"))),c.default.createElement("span",{style:{color:e.name.toLocaleUpperCase()==="DELETE"?"red":"black"}},e.name)),e.subtitle&&c.default.createElement("span",{style:{fontSize:12}},e.subtitle))),(d=e.shortcut)!=null&&d.length?c.default.createElement("div",{"aria-hidden":!0,style:{display:"grid",gridAutoFlow:"column",gap:"4px"}},e.shortcut.map(m=>c.default.createElement("kbd",{key:m,style:{padding:"4px 6px",background:"rgba(0 0 0 / .1)",borderRadius:"4px",fontSize:14}},m))):null)});W.displayName="ResultItem";var $=B(require("react"));var j=({commandBarProps:e})=>{let t=(0,$.useContext)(q);P();let o={...t,...e};return $.default.createElement(U,{...o})};var q=(0,k.createContext)({}),It=({children:e,commandBarProps:t})=>k.default.createElement(q.Provider,{value:t!=null?t:{}},k.default.createElement(rt.KBarProvider,null,e));
//# sourceMappingURL=index.js.map